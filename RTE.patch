diff -ur --strip-trailing-cr RTE.orig/Device/TZ1001MBG/RTE_Device.h RTE/Device/TZ1001MBG/RTE_Device.h
--- RTE.orig/Device/TZ1001MBG/RTE_Device.h	2015-03-03 08:35:58 +0900
+++ RTE/Device/TZ1001MBG/RTE_Device.h	2015-07-02 11:32:37 +0900
@@ -75,38 +75,38 @@
 //  <o30> GPIO_30 Pin <0=>(disabled) <1=>MCU_GPIO_30
 //  <o31> GPIO_31 Pin <0=>(disabled) <1=>MCU_GPIO_31
 #if RTE_GPIO
-#define RTE_GPIO_0_ID 1
+#define RTE_GPIO_0_ID 0
 #define RTE_GPIO_1_ID 1
-#define RTE_GPIO_2_ID 1
+#define RTE_GPIO_2_ID 0
 #define RTE_GPIO_3_ID 1
 #define RTE_GPIO_4_ID 1
-#define RTE_GPIO_5_ID 1
-#define RTE_GPIO_6_ID 1
+#define RTE_GPIO_5_ID 0
+#define RTE_GPIO_6_ID 0
 #define RTE_GPIO_7_ID 1
 #define RTE_GPIO_8_ID 1
 #define RTE_GPIO_9_ID 1
 #define RTE_GPIO_10_ID 1
 #define RTE_GPIO_11_ID 1
-#define RTE_GPIO_12_ID 1
-#define RTE_GPIO_13_ID 1
-#define RTE_GPIO_14_ID 1
-#define RTE_GPIO_15_ID 1
-#define RTE_GPIO_16_ID 0
-#define RTE_GPIO_17_ID 0
-#define RTE_GPIO_18_ID 0
-#define RTE_GPIO_19_ID 0
-#define RTE_GPIO_20_ID 0
-#define RTE_GPIO_21_ID 0
-#define RTE_GPIO_22_ID 0
-#define RTE_GPIO_23_ID 0
-#define RTE_GPIO_24_ID 1
-#define RTE_GPIO_25_ID 1
-#define RTE_GPIO_26_ID 1
-#define RTE_GPIO_27_ID 1
-#define RTE_GPIO_28_ID 1
-#define RTE_GPIO_29_ID 1
-#define RTE_GPIO_30_ID 1
-#define RTE_GPIO_31_ID 1
+#define RTE_GPIO_12_ID 0
+#define RTE_GPIO_13_ID 0
+#define RTE_GPIO_14_ID 0
+#define RTE_GPIO_15_ID 0
+#define RTE_GPIO_16_ID 1
+#define RTE_GPIO_17_ID 1
+#define RTE_GPIO_18_ID 2
+#define RTE_GPIO_19_ID 2
+#define RTE_GPIO_20_ID 1
+#define RTE_GPIO_21_ID 1
+#define RTE_GPIO_22_ID 2
+#define RTE_GPIO_23_ID 2
+#define RTE_GPIO_24_ID 0
+#define RTE_GPIO_25_ID 0
+#define RTE_GPIO_26_ID 0
+#define RTE_GPIO_27_ID 0
+#define RTE_GPIO_28_ID 0
+#define RTE_GPIO_29_ID 0
+#define RTE_GPIO_30_ID 0
+#define RTE_GPIO_31_ID 0
 #else
 #define RTE_GPIO_0_ID 0
 #define RTE_GPIO_1_ID 0
@@ -285,10 +285,10 @@
 //  </e>
 #define RTE_SPI3 0
 #if RTE_SPI3
-#define RTE_SPIM3_CS_N_ID 1
-#define RTE_SPIM3_CLK_ID 1
-#define RTE_SPIM3_MOSI_ID 1
-#define RTE_SPIM3_MISO_ID 1
+#define RTE_SPIM3_CS_N_ID 2
+#define RTE_SPIM3_CLK_ID 2
+#define RTE_SPIM3_MOSI_ID 2
+#define RTE_SPIM3_MISO_ID 2
 #define RTE_SPIM3_DRIVE_CAPABILITY 0
 #define RTE_SPIM3_RESISTOR         0
 #define RTE_SPIM3_DMA_RX 0
@@ -379,8 +379,8 @@
 //  </e>
 #define RTE_I2C2 0
 #if RTE_I2C2
-#define RTE_I2C2_DATA_ID 1
-#define RTE_I2C2_CLK_ID 1
+#define RTE_I2C2_DATA_ID 2
+#define RTE_I2C2_CLK_ID 2
 #define RTE_I2C2_DRIVE_CAPABILITY 0
 #define RTE_I2C2_RESISTOR 1
 #define RTE_I2C2_DMA_RX 0
@@ -437,7 +437,7 @@
 // <i> Configuration settings for Driver_UART1 in component ::Drivers:UART
 //  <o1> UA1_RXD pin <1=>MCU_UA1_RXD
 //  <o2> UA1_TXD pin <1=>MCU_UA1_TXD
-#define RTE_UART1 0
+#define RTE_UART1 1
 #if RTE_UART1
 #define RTE_UA1_RXD_ID 1
 #define RTE_UA1_TXD_ID 1
diff -ur --strip-trailing-cr RTE.orig/Middleware/TZ1001MBG/tz1sm_config.h RTE/Middleware/TZ1001MBG/tz1sm_config.h
--- RTE.orig/Middleware/TZ1001MBG/tz1sm_config.h	2015-03-27 09:49:43 +0900
+++ RTE/Middleware/TZ1001MBG/tz1sm_config.h	2015-07-02 11:32:37 +0900
@@ -53,14 +53,14 @@
 #undef TZ1XXX_BOARD_DEVELOPER_A
 #undef TZ1XXX_BOARD_REFERENCE_A
 #undef TZ1XXX_BOARD_REFERENCE_B
-#undef TZ1XXX_BOARD_REFERENCE_X
+#define TZ1XXX_BOARD_REFERENCE_X
 
 
 /*
  * NON-OS, RTOS
  *
  */
-#undef TWIC_RTOS__NONOS
+#define TWIC_RTOS__NONOS
 #undef TWIC_RTOS__CMSIS_RTOS
 #undef TWIC_RTOS__FREERTOS
 #undef TWIC_RTOS__FREERTOS_TICKLESS
@@ -71,7 +71,7 @@
  * disable it for saving memory (-2.5kB).
  *
  */
-#undef TWIC_CONFIG_ENABLE_SCAN
+#define TWIC_CONFIG_ENABLE_SCAN
 
 
 /*
@@ -82,8 +82,8 @@
  * disable it for saving memory.
  *
  */
-#undef TWIC_CONFIG_SM_INITIATOR
-#undef TWIC_CONFIG_SM_RESPONDER
+#define TWIC_CONFIG_SM_INITIATOR
+#define TWIC_CONFIG_SM_RESPONDER
 
 
 /*
@@ -91,17 +91,17 @@
  * for saving memory.
  *
  */
-#undef TWIC_API_LELMRESOLVEBDADDR
-#undef TWIC_API_LEDELWHITELIST
-#undef TWIC_API_LEADDWHITELIST
-#undef TWIC_API_LEREADWHITELISTSIZE
-#undef TWIC_API_LEREADLOCALSUPPORTEDFEATURES
-#undef TWIC_API_LESETHOSTCHANNELCLASSIFICATION
-#undef TWIC_API_LEREADCHANNELMAP
-#undef TWIC_API_LEREADSUPPORTEDSTATES
-#undef TWIC_API_LELMGENRESOLVABLEBDADDR
-#undef TWIC_API_LESETRANDOMADDRESS
-#undef TWIC_API_LESMSETIRVALUE
+#define TWIC_API_LELMRESOLVEBDADDR
+#define TWIC_API_LEDELWHITELIST
+#define TWIC_API_LEADDWHITELIST
+#define TWIC_API_LEREADWHITELISTSIZE
+#define TWIC_API_LEREADLOCALSUPPORTEDFEATURES
+#define TWIC_API_LESETHOSTCHANNELCLASSIFICATION
+#define TWIC_API_LEREADCHANNELMAP
+#define TWIC_API_LEREADSUPPORTEDSTATES
+#define TWIC_API_LELMGENRESOLVABLEBDADDR
+#define TWIC_API_LESETRANDOMADDRESS
+#define TWIC_API_LESMSETIRVALUE
 
 
 /*
@@ -109,12 +109,12 @@
  * for saving memory.
  *
  */
-#undef TWIC_API_GATTSERVERLONGCHARVALREADOUTRESPONSE
-#undef TWIC_API_GATTSERVERLONGCHARDESPREADOUTRESPONSE
-#undef TWIC_API_GATTSERVERLONGCHARVALPREPAREWRITEINRESPONSE
-#undef TWIC_API_GATTSERVERLONGCHARDESPPREPAREWRITEINRESPONSE
-#undef TWIC_API_GATTSERVEREXECCHARVALWRITEINRESPONSE
-#undef TWIC_API_GATTSERVEREXECCHARDESPWRITEINRESPONSE
+#define TWIC_API_GATTSERVERLONGCHARVALREADOUTRESPONSE
+#define TWIC_API_GATTSERVERLONGCHARDESPREADOUTRESPONSE
+#define TWIC_API_GATTSERVERLONGCHARVALPREPAREWRITEINRESPONSE
+#define TWIC_API_GATTSERVERLONGCHARDESPPREPAREWRITEINRESPONSE
+#define TWIC_API_GATTSERVEREXECCHARVALWRITEINRESPONSE
+#define TWIC_API_GATTSERVEREXECCHARDESPWRITEINRESPONSE
 
 
 /*
@@ -122,27 +122,27 @@
  * for saving memory.
  *
  */
-#undef TWIC_API_GATTCLIENTEXGMTU
-#undef TWIC_API_GATTCLIENTDISCOVERPRIMARYSERVICE
-#undef TWIC_API_GATTCLIENTDISCOVERPRIMARYSERVICEBYSERVICEUUID
-#undef TWIC_API_GATTCLIENTFINDINCLUDEDSERVICE
-#undef TWIC_API_GATTCLIENTDISCOVERALLCHARACTERISTICS
-#undef TWIC_API_GATTCLIENTDISCOVERCHARACTERISTICSBYUUID
-#undef TWIC_API_GATTCLIENTDISCOVERALLDESCRIPTORS
-#undef TWIC_API_GATTCLIENTREADCHARACTERISTICVALUE
-#undef TWIC_API_GATTCLIENTREADUSINGCHARACTERISTICUUID
-#undef TWIC_API_GATTCLIENTWRITECHARACTERISTICVALUE
-#undef TWIC_API_GATTCLIENTRELIABLEWRITE
-#undef TWIC_API_GATTCLIENTWRITEWITHOUTRESPONSE
-#undef TWIC_API_GATTCLIENTSIGNEDWRITEWITHOUTRESPONSE
-#undef TWIC_API_GATTCLIENTINDICATIONCONFIRMATIONRESPONSE
-#undef TWIC_API_GATTCLIENTREADCHARACTERISTICDESCRIPTOR
-#undef TWIC_API_GATTCLIENTREADMULTIPLECHARVALUES
-#undef TWIC_API_GATTCLIENTWRITECHARACTERISTICDESCRIPTOR
-#undef TWIC_API_GATTCLIENTREADLONGCHARACTERISTICVALUE
-#undef TWIC_API_GATTCLIENTREADLONGCHARACTERISTICDESCRIPTOR
-#undef TWIC_API_GATTCLIENTWRITELONGCHARACTERISTICVALUE
-#undef TWIC_API_GATTCLIENTWRITELONGCHARACTERISTICDESCRIPTOR
+#define TWIC_API_GATTCLIENTEXGMTU
+#define TWIC_API_GATTCLIENTDISCOVERPRIMARYSERVICE
+#define TWIC_API_GATTCLIENTDISCOVERPRIMARYSERVICEBYSERVICEUUID
+#define TWIC_API_GATTCLIENTFINDINCLUDEDSERVICE
+#define TWIC_API_GATTCLIENTDISCOVERALLCHARACTERISTICS
+#define TWIC_API_GATTCLIENTDISCOVERCHARACTERISTICSBYUUID
+#define TWIC_API_GATTCLIENTDISCOVERALLDESCRIPTORS
+#define TWIC_API_GATTCLIENTREADCHARACTERISTICVALUE
+#define TWIC_API_GATTCLIENTREADUSINGCHARACTERISTICUUID
+#define TWIC_API_GATTCLIENTWRITECHARACTERISTICVALUE
+#define TWIC_API_GATTCLIENTRELIABLEWRITE
+#define TWIC_API_GATTCLIENTWRITEWITHOUTRESPONSE
+#define TWIC_API_GATTCLIENTSIGNEDWRITEWITHOUTRESPONSE
+#define TWIC_API_GATTCLIENTINDICATIONCONFIRMATIONRESPONSE
+#define TWIC_API_GATTCLIENTREADCHARACTERISTICDESCRIPTOR
+#define TWIC_API_GATTCLIENTREADMULTIPLECHARVALUES
+#define TWIC_API_GATTCLIENTWRITECHARACTERISTICDESCRIPTOR
+#define TWIC_API_GATTCLIENTREADLONGCHARACTERISTICVALUE
+#define TWIC_API_GATTCLIENTREADLONGCHARACTERISTICDESCRIPTOR
+#define TWIC_API_GATTCLIENTWRITELONGCHARACTERISTICVALUE
+#define TWIC_API_GATTCLIENTWRITELONGCHARACTERISTICDESCRIPTOR
 
 
 /*
@@ -150,7 +150,7 @@
  * saving memory.
  *
  */
-#undef TWIC_API_LECEDBUSWRITE
+#define TWIC_API_LECEDBUSWRITE
 
 
 /*
@@ -158,9 +158,9 @@
  * Enable each Service if the Service Generator is used.
  */
 /* GA Service Descripter and Characteristic attribute data. */
-#undef TWIC_UTIL_GA_SERVICE
+#define TWIC_UTIL_GA_SERVICE
 /* DI Service Descripter and Characteristic attribute data. */
-#undef TWIC_UTIL_DI_SERVICE
+#define TWIC_UTIL_DI_SERVICE
 /* HR Service Descripter and Characteristic attribute data. */
 #undef TWIC_UTIL_HR_SERVICE
 /* Blood Pressure Service Descripter and Characteristic attribute data. */
@@ -178,10 +178,10 @@
 /* Health Thermometer Service */
 #undef TWIC_UTIL_HT_SERVICE
 /* User defined Service 128bit UUID (Experimental Temporary 128bit Service) */
-#undef TWIC_UTIL_UU_SERVICE
-#undef TWIC_UTIL_UU_CHARACTERISTICS
+#define TWIC_UTIL_UU_SERVICE
+#define TWIC_UTIL_UU_CHARACTERISTICS
 /* ANCS */
-#undef TWIC_UTIL_ANCS
+#define TWIC_UTIL_ANCS
 
 
 /*
@@ -234,6 +234,7 @@
 #elif defined(TZ1XXX_BOARD_REFERENCE_X)
 
 #define TWIC_BUTTON_GPIO_NO (2)
+#define TWIC_BUTTON_GPIO_NO_BB  (6)
 
 #endif
 
@@ -306,7 +306,7 @@
 #define TWIC_DEBUG_UART_CH_1   (1)
 
 /* TWIC_DEBUG_LOG_TRACE must be defined when DEBUG UART is used. */
-#define TWIC_DEBUG_LOG_TRACE /* enable trace log */
+#undef TWIC_DEBUG_LOG_TRACE /* enable trace log */
 
 /* TWIC_DEBUG_LOG_TRACE must be defined when TWIC_DEBUG_LOG_UART is used. */
 #undef TWIC_DEBUG_LOG_UART /* enable controller communication log */
 
diff -ur --strip-trailing-cr RTE.orig/Middleware/TZ1001MBG/tz1sm_hal.c RTE/Middleware/TZ1001MBG/tz1sm_hal.c
--- RTE.orig/Middleware/TZ1001MBG/tz1sm_hal.c	2015-04-06 13:02:33 +0900
+++ RTE/Middleware/TZ1001MBG/tz1sm_hal.c	2015-07-02 11:32:37 +0900
@@ -969,6 +969,15 @@
     if (pmu_status != PMU_OK)
       return 1;
   }
+  #if defined(TWIC_BUTTON_GPIO_NO_BB)
+  if ((TWIC_BUTTON_GPIO_NO_BB > 0  && TWIC_BUTTON_GPIO_NO_BB < 16) ||
+      (TWIC_BUTTON_GPIO_NO_BB > 23 && TWIC_BUTTON_GPIO_NO_BB < 32)) {
+    pmu_status = Driver_PMU.StandbyInputBuffer((PMU_IO_FUNC)TWIC_BUTTON_GPIO_NO_BB, 0);
+    if (pmu_status != PMU_OK) {
+      return 1;
+    }        
+  }
+  #endif
 #endif
 
   return 0;
@@ -986,6 +995,15 @@
     if (pmu_status != PMU_OK)
       return 1;
   }
+  #if defined(TWIC_BUTTON_GPIO_NO_BB)
+  if ((TWIC_BUTTON_GPIO_NO_BB > 0  && TWIC_BUTTON_GPIO_NO_BB < 16) ||
+      (TWIC_BUTTON_GPIO_NO_BB > 23 && TWIC_BUTTON_GPIO_NO_BB < 32)) {
+    pmu_status = Driver_PMU.StandbyInputBuffer((PMU_IO_FUNC)TWIC_BUTTON_GPIO_NO_BB, 1);
+    if (pmu_status != PMU_OK) {
+      return 1;
+    }        
+  }
+  #endif
 #endif
 
   return 0;  
@@ -2006,6 +2024,11 @@
   if (ret != GPIO_OK)
     return 1;
 
+  #if defined(TWIC_BUTTON_GPIO_NO_BB)
+  ret = Driver_GPIO.Configure(TWIC_BUTTON_GPIO_NO_BB, GPIO_DIRECTION_INPUT_HI_Z, GPIO_EVENT_EDGE_NEG, handler);
+  if (ret != GPIO_OK) return 1;
+  #endif
+  
   return 0;
 }
 
diff -ur --strip-trailing-cr RTE.orig/Middleware/TZ1001MBG/tz1sm_hal.h RTE/Middleware/TZ1001MBG/tz1sm_hal.h
--- RTE.orig/Middleware/TZ1001MBG/tz1sm_hal.h	2015-03-02 20:33:45 +0900
+++ RTE/Middleware/TZ1001MBG/tz1sm_hal.h	2015-07-02 11:43:51 +0900
@@ -89,7 +89,6 @@
 #define TWIC_TYPES__TYPES
 #undef  TWIC_STDIO__STDIO
 #define TWIC_POSIX__POSIX
-#define TWIC_RTOS__CMSIS_RTOS
 #define TWIC_PMU__CMSIS_PMU
 #define TWIC_PMU__CMSIS_RTC
 #define TWIC_PMU__CMSIS_MISC
 
